(()=>{"use strict";var e={698:(e,s)=>{function n(e){return"object"!=typeof e?e:e.message?e.message:"unknown kondor error"}Object.defineProperty(s,"__esModule",{value:!0}),s.Messenger=void 0;class t{constructor(e){if(this.listeners=[],this.onExtensionRequest=async()=>({}),this.onDomRequest=async()=>({}),e){if(e.onExtensionRequest){this.onExtensionRequest=e.onExtensionRequest;const s=async(e,s,n)=>{n();const{id:t,command:o}=e;if(!o)return;let r={id:t};try{const n=await this.onExtensionRequest(e,t,s);if("object"==typeof n&&null!==n&&n._derived)return;r.result=n}catch(e){r.error=e.message}(void 0!==r.result||r.error)&&this.sendResponse("extension",r,s)};this.listeners.push({type:"extension",id:"onRequest",listener:s}),chrome.runtime.onMessage.addListener(s)}if(e.onDomRequest){this.onDomRequest=e.onDomRequest;const s=async e=>{const{id:s,command:n}=e.data;if(!n)return;let t={id:s};try{const n=await this.onDomRequest(e,s);if("object"==typeof n&&null!==n&&n._derived)return;t.result=n}catch(e){t.error=e.message}(void 0!==t.result||t.error)&&this.sendResponse("dom",t)};this.listeners.push({type:"dom",id:"onRequest",listener:s}),window.addEventListener("message",s)}}}sendResponse(e,s,n){"dom"===e?window.postMessage(s,"*"):n&&n.tab?chrome.tabs.sendMessage(n.tab.id,s):chrome.runtime.sendMessage(s)}async sendDomMessage(e,s,t){const o=crypto.randomUUID();return new Promise(((r,i)=>{const a=e=>{if(e.data.command)return;const{id:s,result:t,error:a}=e.data;s===o&&(a?i(new Error(n(a))):r(t),this.removeListener(o))};this.listeners.push({type:"dom",id:o,listener:a}),window.addEventListener("message",a),window.postMessage({id:o,command:s,args:t,to:e},"*")}))}async sendExtensionMessage(e,s,t,o){const r=crypto.randomUUID();return new Promise(((i,a)=>{const d=(e,s,t)=>{if(t(),e.command)return;const{id:o,result:d,error:c}=e;o===r&&(c?a(new Error(n(c))):i(d),this.removeListener(r))};this.listeners.push({type:"extension",id:r,listener:d}),chrome.runtime.onMessage.addListener(d);const c=()=>{["popup","background"].includes(e)?chrome.runtime.sendMessage({id:r,command:s,args:t,to:e}):chrome.tabs.sendMessage(e,{id:r,command:s,args:t,to:e})};c(),o&&o.timeout&&setTimeout((()=>{a(new Error("Connection lost")),this.removeListener(r)}),o.timeout),o&&o.ping&&(async()=>{let s=(null==o?void 0:o.retries)||0;for(await new Promise((e=>setTimeout(e,1e3)));this.listeners.find((e=>e.id===r));)try{await this.sendExtensionMessage(e,"ping",{id:r,to:e},{timeout:80}),await new Promise((e=>setTimeout(e,1e3)))}catch(e){if(s<=0){a(e),this.removeListener(r);break}s-=1,console.log(`retrying ${r}. remaining retries: ${s}`),c(),await new Promise((e=>setTimeout(e,100)))}})()}))}removeListener(e){const s=this.listeners.findIndex((s=>s.id===e));if(s<0)return;const n=this.listeners.splice(s,1),{listener:t,type:o}=n[0];"dom"===o?window.removeEventListener("message",t):chrome.runtime.onMessage.removeListener(t)}removeListeners(){this.listeners.forEach((e=>{const{type:s,listener:n}=e;"dom"===s?window.removeEventListener("message",n):chrome.runtime.onMessage.removeListener(n)})),this.listeners=[]}}s.default=t,s.Messenger=t},339:(e,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getAccounts=void 0;const t=new(n(698).Messenger);async function o(){return t.sendDomMessage("popup","getAccounts",{})}s.getAccounts=o,s.default=o},599:(e,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.provider=void 0;const t=new(n(698).Messenger)({});s.provider={call:async(e,s)=>t.sendDomMessage("background","provider:call",{method:e,params:s}),getNonce:async e=>t.sendDomMessage("background","provider:getNonce",{account:e}),getAccountRc:async e=>t.sendDomMessage("background","provider:getAccountRc",{account:e}),getTransactionsById:async e=>t.sendDomMessage("background","provider:getTransactionsById",{transactionIds:e}),getBlocksById:async e=>t.sendDomMessage("background","provider:getBlocksById",{blockIds:e}),getHeadInfo:async()=>t.sendDomMessage("background","provider:getHeadInfo"),getChainId:async()=>t.sendDomMessage("background","provider:getChainId"),getBlocks:async(e,s=1,n)=>t.sendDomMessage("background","provider:getBlocks",{height:e,numBlocks:s,idRef:n}),getBlock:async e=>t.sendDomMessage("background","provider:getBlock",{height:e}),wait:async(e,s="byBlock",n=3e4)=>t.sendDomMessage("background","provider:wait",{txId:e,type:s,timeout:n}),sendTransaction:async e=>(await t.sendDomMessage("background","provider:sendTransaction",{transaction:e}),{}),submitBlock:async e=>t.sendDomMessage("background","provider:submitBlock",{block:e}),readContract:async e=>t.sendDomMessage("background","provider:readContract",{operation:e})},s.default=s.provider},942:(e,s,n)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.signer=void 0;const t=new(n(698).Messenger)({});s.signer={getAddress:()=>{throw new Error("getAddress is not available. Please use getAccounts from kondor")},getPrivateKey:()=>{throw new Error("getPrivateKey is not available")},signTransaction:()=>{throw new Error("signTransaction is not available. Use sendTransaction instead")},signHash:()=>{throw new Error("signHash is not available. Use sendTransaction instead")},prepareBlock:()=>{throw new Error("prepareBlock is not available")},signBlock:()=>{throw new Error("signBlock is not available")},prepareTransaction:async e=>await t.sendDomMessage("background","signer:prepareTransaction",{transaction:e}),sendTransaction:async(e,s)=>{const{transaction:n,receipt:o}=await t.sendDomMessage("popup","signer:sendTransaction",{tx:e,abis:s});return{receipt:o,transaction:{...n,wait:async(e="byBlock",s=3e4)=>t.sendDomMessage("background","provider:wait",{txId:n.id,type:e,timeout:s})}}}},s.default=s.signer}},s={};function n(t){var o=s[t];if(void 0!==o)return o.exports;var r=s[t]={exports:{}};return e[t](r,r.exports,n),r.exports}(()=>{const e=n(599),s=n(942),t=n(339);window.kondor={provider:e.provider,signer:s.signer,getAccounts:t.getAccounts}})()})();